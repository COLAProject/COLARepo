tosca_definitions_version: tosca_simple_yaml_1_0

policy_types:
  tosca.policy.Security.Auhorization:
    derived_from: tosca.policies.Security
    description: authorization policy derived from security
    properties:
      stage:
        type: string
        description: The stage that will be affected by the policy
        default: created
      priority:
        type: integer
        description: the priority with which the policy will be executed
        default: 100
      service:
        type: tosca.capabilities.Endpoint
        description: describe the service that required the authorization requires protocol
        properties:
          url_path:
            type: string
            required: true
          port:
            type: tosca.datatypes.network.PortDef
            required: true
      service_name:
        type: string
        description: defines the name of the remote Autorization Service
